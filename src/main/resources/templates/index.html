<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Part 1</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">

    <link rel="stylesheet" href="../static/css/styles.css"/>
    <script src="../static/js/script.js" th:src="@{/js/script.js}"></script>
</head>
<body class="auto-theme">
<!-- 1ere partie -->
<div class="sidebar">
    <!-- Icone pour changement de lumière -->
    <div class="icon" id="theme-icon">
        <i class="bi bi-brightness-high"></i>
        <div class="tooltip">Changer le thème</div>
    </div>

    <!-- Dropdown pour les thèmes -->
    <div class="dropdown">
        <div class="icon" data-theme="light">
            <i class="bi bi-sun"></i>
            <div class="tooltip"></div>
        </div>
        <div class="icon" data-theme="dark">
            <i class="bi bi-moon"></i>
            <div class="tooltip"></div>
        </div>
        <div class="icon" data-theme="auto">
            <i class="bi bi-circle-half"></i>
            <div class="tooltip"></div>
        </div>
    </div>
    <!-- Icone pour contact -->
    <div class="icon contact">
        <i class="bi bi-envelope"></i>
        <div class="tooltip">Nous contacter</div>
    </div>
</div>


<!-- Par du milieu -->
<div class="scrollable-section">
    <!-- Flèche en haut de la section défilable -->
    <div class="dashboard" style="width: 8cm; background-color: #0d4e2f;">
        <button class="scroll-btn top" onclick="scrollSection('up')"></button>
        <!-- La section défilable -->
        <div class="dashboard-title">
            <i class="bi bi-speedometer"></i> Tableau de Bord
        </div>
        <!-- Section Licences -->
        <div class="section">
            <div class="section-header" id="section-1">
                <i class="bi bi-card-text"></i>
                <span>Licences</span>
                <button class="toggle-btn" data-target="subsection-1">+</button>
            </div>
            <div class="subsections" id="subsection-1">
                <div class="branch">
                    <div class="subsection-item">
                        <i class="bi bi-plus-circle"></i> Ajout
                    </div>
                    <div class="subsection-item">
                        <i class="bi bi-pencil-square"></i> Modification
                    </div>
                    <div class="subsection-item">
                        <i class="bi bi-list"></i> Listes
                    </div>
                    <div class="subsection-item">
                        <i class="bi bi-trash"></i> Suppression
                    </div>
                </div>
            </div>
        </div>
        <!-- Section Master -->
        <div class="section">
            <div class="section-header" id="section-2">
                <i class="bi bi-book"></i>
                <span>Master</span>
                <button class="toggle-btn" data-target="subsection-2">+</button>
            </div>
            <div class="subsections" id="subsection-2">
                <div class="branch">
                    <div class="subsection-item">
                        <i class="bi bi-plus-circle"></i> Ajout
                    </div>
                    <div class="subsection-item">
                        <i class="bi bi-pencil-square"></i> Modification
                    </div>
                    <div class="subsection-item">
                        <i class="bi bi-list"></i> Listes
                    </div>
                    <div class="subsection-item">
                        <i class="bi bi-trash"></i> Suppression
                    </div>
                </div>
            </div>
        </div>
        <!-- Section Thèses -->
        <div class="section">
            <div class="section-header" id="section-3">
                <i class="bi bi-file-earmark-text"></i>
                <span>Thèses</span>
                <button class="toggle-btn" data-target="subsection-3">+</button>
            </div>
            <div class="subsections" id="subsection-3">
                <div class="branch">
                    <div class="subsection-item">
                        <i class="bi bi-plus-circle"></i> Ajout
                    </div>
                    <div class="subsection-item">
                        <i class="bi bi-pencil-square"></i> Modification
                    </div>
                    <div class="subsection-item">
                        <i class="bi bi-list"></i> Listes
                    </div>
                    <div class="subsection-item">
                        <i class="bi bi-trash"></i> Suppression
                    </div>
                </div>
            </div>
        </div>
        <!-- Section Utilisateurs -->
        <div class="section">
            <div class="section-header" id="section-4">
                <i class="bi bi-person-fill"></i>
                <span>Gestion des Utilisateurs</span>
                <button class="toggle-btn" data-target="subsection-4">+</button>
            </div>
            <div class="subsections" id="subsection-4">
                <div class="branch">
                    <div class="subsection-item">
                        <i class="bi bi-person-add"></i> Ajout
                    </div>
                    <div class="subsection-item">
                        <i class="bi bi-person-check"></i> Modification
                    </div>
                    <div class="subsection-item">
                        <i class="bi bi-person-lines-fill"></i> Listes
                    </div>
                    <div class="subsection-item">
                        <i class="bi bi-person-x"></i> Suppression
                    </div>
                </div>
            </div>
        </div>
        <!-- Flèche en bas de la section défilable -->
        <button class="scroll-btn bottom" onclick="scrollSection('down')"></button>
    </div>
</div>

<!-- Header avec texte animé et icônes -->
<!-- Conteneur global pour tout le contenu -->
<div class="container">
    <!-- Header avec texte animé et icônes -->
    <div class="main-header">
        <!-- Bloc du texte animé -->
        <div class="text-block">
            <nav class="navbar navbar-expand-lg navbar-dark">
                <div class="container-fluid">
                    <a class="navbar-brand" href="#">
                        <span id="typing-text"></span> <!-- Le texte animé sera inséré ici -->
                    </a>
                </div>
            </nav>
        </div>
        <!-- Bloc des icônes aligné à droite -->
        <div class="icon-container">
            <!-- Icône de notification -->
            <i class="fas fa-bell notification-icon me-2" onclick="toggleSidebar('sidebar-notification')"></i>
            <!-- Icône utilisateur -->
            <div class="user-icon" onclick="toggleSidebar('sidebar-user')">
                <i class="fas fa-user"></i>
            </div>
            <!-- Menu contextuel utilisateur -->
            <div id="sidebar-user" class="dropdown-menu p-3" style="display: none; position: absolute; right: 10px; top: 50px;">
                <p class="mb-2 font-weight-bold">Connecté en tant que :</p>
                <p class="mb-2" th:text="'Nom : ' + ${nom}">Nom</p>
                <p class="mb-2" th:text="'Prénom : ' + ${prenom}">Prénom</p>
                <p class="mb-2" th:text="'Rôle : ' + ${roles}">Rôle(s)</p>
                <!-- Bouton de déconnexion avec redirection -->
                <a class="btn btn-danger btn-sm w-100" href="/logout">Se déconnecter</a>
                <hr />
                <div class="d-flex align-items-center">
                    <i class="fas fa-bell me-2 text-primary"></i>
                    <span id="notification-count" class="badge bg-danger">3</span>
                    <span class="ms-2">Notifications</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Bloc de recherche sous le header -->
    <div class="search-container">
        <!-- Formulaire de recherche -->
        <form id="searchForm" action="/memoires/liste" method="get">
            <div class="row align-items-center justify-content-center">
                <div class="col-md-1 mb-2">
                    <input type="text" class="form-control" id="searchCote" name="cote" placeholder="Cote">
                </div>

                <div class="col-md-1 mb-2">
                    <input type="text" class="form-control" id="searchTitre" name="titre" placeholder="Titre">
                </div>

                <div class="col-md-1 mb-2">
                    <input type="text" class="form-control" id="searchEtudiant" name="etudiant" placeholder="l'étudiant">
                </div>

                <div class="col-md-1 mb-2">
                    <input type="text" class="form-control" id="searchEncadrant" name="encadrant" placeholder="l'encadrant">
                </div>

                <div class="col-md-1 mb-2">
                    <input type="text" class="form-control" id="searchFiliere" name="filiere" placeholder="Agroforesterie">
                </div>

                <div class="col-md-1 mb-2">
                    <input type="number" class="form-control" id="searchAnnee" name="annee" placeholder="2024">
                </div>

                <div class="col-md-1 mb-2">
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>
        </form>
        <div th:if="${errorMessage != null}" class="alert alert-danger">
            <p th:text="${errorMessage}"></p>
        </div>

        <!-- Bloc de statistiques -->
        <div th:unless="${errorMessage != null}" class="row mb-4 mt-4">
            <div class="stats-container">
                <!-- Licence -->
                <div class="stats-card">
                    <div class="card-text">
                        <div class="card-header">licence</div>
                        <h3 class="fw-bold" th:text="${licenceCount}">0</h3>
                    </div>
                    <div class="card-icon">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                </div>
                <!-- Master -->
                <div class="stats-card">
                    <div class="card-text">
                        <div class="card-header">master</div>
                        <h3 class="fw-bold" th:text="${masterCount}">0</h3>
                    </div>
                    <div class="card-icon">
                        <i class="fas fa-user-graduate"></i>
                    </div>
                </div>
                <!-- Doctorat -->
                <div class="stats-card">
                    <div class="card-text">
                        <div class="card-header">doctorat</div>
                        <h3 class="fw-bold" th:text="${doctoratCount}">0</h3>
                    </div>
                    <div class="card-icon">
                        <i class="fas fa-university"></i>
                    </div>
                </div>
                <!-- Statistiques -->
                <div class="stats-card">
                    <div class="card-text">
                        <div class="card-header">statistiques</div>
                        <h3 class="fw-bold">2024</h3>
                    </div>
                    <div class="card-icon">
                        <i class="fas fa-chart-bar"></i>
                    </div>
                </div>
                <!-- diagramme en barre des memoires-->
                <div class="charts-container">
                    <div class="chart-wrapper">
                        <h4 class="chart-title">Diagramme en Barres</h4>
                        <canvas id="statsChart"></canvas>
                    </div>
                    <div class="chart-wrapper">
                        <h4 class="chart-title">Diagramme en Courbes</h4>
                        <canvas id="evolutionCharts"></canvas>
                    </div>
                    <div class="chart-wrapper">
                        <h4 class="chart-title">Diagramme Circulaire</h4>
                        <canvas id="pieChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Statistiques -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
