<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Ajouter de these</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-4">
    <h1 class="text-center mb-4">Ajouter une Thèse</h1>
    <form id="theseForm" th:action="@{/theses/ajouter}" method="post">
        <!-- Affichage des erreurs -->
        <div th:if="${error}">
            <p style="color: red;" th:text="${error}"></p>
        </div>
        <input type="hidden" name="type" value="DOCTORAT">
        <h3>Formulaire pour Thèse</h3>
        <div class="mb-3">
            <label for="titreTHESE" class="form-label">Titre :</label>
            <input type="text" class="form-control" id="titreTHESE" name="titre" required>
        </div>
        <div class="mb-3">
            <label for="etudiantNomTHESE" class="form-label">Nom de l'Étudiant :</label>
            <input type="text" class="form-control" id="etudiantNomTHESE" name="etudiantNom" required>
        </div>
        <div class="mb-3">
            <label for="etudiantPrenomTHESE" class="form-label">Prénom de l'Étudiant :</label>
            <input type="text" class="form-control" id="etudiantPrenomTHESE" name="etudiantPrenom" required>
        </div>
        <div class="mb-3">
            <label for="encadrantNomTHESE" class="form-label">Nom de l'Encadrant :</label>
            <input type="text" class="form-control" id="encadrantNomTHESE" name="encadrantNom" required>
        </div>
        <div class="mb-3">
            <label for="encadrantPrenomTHESE" class="form-label">Prénom de l'Encadrant :</label>
            <input type="text" class="form-control" id="encadrantPrenomTHESE" name="encadrantPrenom" required>
        </div>
        <div class="mb-3">
            <label for="anneeTHESE" class="form-label">Année :</label>
            <input type="number" class="form-control" id="anneeTHESE" name="annee" min="1900" max="2099" required>
        </div>
        <div class="mb-3">
            <label for="exemplairesTHESE" class="form-label">Nombre d'Exemplaires :</label>
            <input type="number" class="form-control" id="exemplairesTHESE" name="exemplaires" min="1" required>
        </div>

        <div class="mb-3">
            <label for="ecoleDoctorale" class="form-label">Ecole Doctorale</label>
            <select id="ecoleDoctorale" name="ecoleDoctorale" class="form-select" onchange="updateUFRDisplay()" required
                    oninvalid="this.setCustomValidity('Veuillez sélectionner une école doctorale.')"
                    oninput="this.setCustomValidity('')">
                <option value="">-- Sélectionner une Ecole Doctorale --</option>
                <option value="Ecole Doctorat Sciences, Technologies et Ingénierie (ED-STI)">Ecole Doctorat Sciences, Technologies et Ingénierie (ED-STI)</option>
                <option value="Ecole Doctorat Espaces, Sociétés et Humanités (ED-ESH)">Ecole Doctorat Espaces, Sociétés et Humanités (ED-ESH)</option>
            </select>
        </div>

        <!-- Affichage dynamique de l'UFR -->
        <div class="mb-3">
            <label for="ufrAffichage" class="form-label">UFR Associé</label>
            <input type="text" class="form-control" id="ufrAffichage" name="ufrAffichage" readonly>
        </div>

        <div class="d-grid">
            <button type="submit" class="btn btn-success">Ajouter Thèse</button>
        </div>
    </form>
</div>
</body>
<script>
  const ecoleDoctoraleData = {
    "Ecole Doctorat Sciences, Technologies et Ingénierie (ED-STI)": "UFR Sciences et Techniques (ST)",
    "Ecole Doctorat Espaces, Sociétés et Humanités (ED-ESH)": "UFR Lettres, Art, Sciences Humaines (LASHU)"
  };

  function updateUFRDisplay() {
    const ecoleSelect = document.getElementById("ecoleDoctorale");
    const ufrInput = document.getElementById("ufrAffichage");
    const selectedEcole = ecoleSelect.value;

    ufrInput.value = ecoleDoctoraleData[selectedEcole] || "";
  }

  document.getElementById("theseForm").addEventListener("submit", function(event) {
    const ufrInput = document.getElementById("ufrAffichage");
    if (!ufrInput.value) {
      event.preventDefault();
      alert("Veuillez sélectionner une École Doctorale valide.");
    }
  });
</script>
</html>
